# Configuration for Split Workflow with Intermediate Results
# This config is designed for the split workflow where preprocessing 
# and report generation are run separately.
#
# Usage:
#   eeg-preprocess-only --bids-root /data --config config_split_workflow.yaml
#   eeg-generate-reports --bids-root /data --all

pipeline:
  # Filtering
  - name: bandpass_filter
    l_freq: 0.5
    h_freq: 40.0
  
  # Re-referencing
  - name: reference
    ref_channels: average
    instance: 'raw'
  
  # Find events from annotations
  - name: find_events
    shortest_event: 1
  
  # Create epochs around events
  - name: epoch
    tmin: -0.2
    tmax: 0.8
    baseline: [null, 0]
    event_id: null
    reject:
      eeg: 1.5e-04
  
  # Save clean epochs to .fif file
  - name: save_clean_instance
    instance: epochs
  
  # Save intermediate results for later report generation
  # This is the key step that enables the split workflow
  - name: save_intermediate_results
    save_raw: true          # Save raw data object
    save_epochs: true       # Save epochs object
    save_ica: true          # Save ICA object (if ICA was performed)
    save_events: true       # Save events array
